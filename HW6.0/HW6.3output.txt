Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 32, 32, 16)        448       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 16, 16, 16)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 16, 16, 12)        1740      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 8, 8, 12)          0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 8, 8, 8)           872       
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 4, 4, 8)           0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 4, 4, 8)           584       
_________________________________________________________________
up_sampling2d (UpSampling2D) (None, 8, 8, 8)           0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 8, 8, 12)          876       
_________________________________________________________________
up_sampling2d_1 (UpSampling2 (None, 16, 16, 12)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 16, 16, 16)        1744      
_________________________________________________________________
up_sampling2d_2 (UpSampling2 (None, 32, 32, 16)        0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 32, 32, 1)         145       
=================================================================
Total params: 6,409
Trainable params: 6,409
Non-trainable params: 0
_________________________________________________________________
(3000, 32, 32, 3)
2021-11-13 13:15:53.309173: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-11-13 13:15:53.309877: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 1599995000 Hz
Epoch 1/4
3/3 [==============================] - 9s 2s/step - loss: 0.2635 - val_loss: 0.1095
Epoch 2/4
3/3 [==============================] - 4s 1s/step - loss: 0.1069 - val_loss: 0.0849
Epoch 3/4
3/3 [==============================] - 4s 1s/step - loss: 0.0842 - val_loss: 0.0747
Epoch 4/4
3/3 [==============================] - 4s 1s/step - loss: 0.0752 - val_loss: 0.0719
dict_keys(['loss', 'val_loss'])
1/1 [==============================] - 1s 673ms/step - loss: 0.0735
threshold is 
0.2938927710056305
(10,)
6920.114937847713
anomaly
13074.826889838412
anomaly
9246.535816834552
anomaly
10276.26630266963
anomaly
2179.368990069623
anomaly
6584.101298662398
anomaly
2545.4126780072147
anomaly
7990.245148985369
anomaly
3834.9705351350863
anomaly
10102.200554777772
anomaly
